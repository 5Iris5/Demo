<!DOCTYPE html>
<html lang="en">
<head>
	<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
	<meta charset="UTF-8">
	<title>waterfall</title>
	<style>
		.container{
			position:relative;
			width:560px;
			margin:0px auto;
		}
		.container img{
			position:absolute;
			margin:10px 0px 0px 10px;
		}
	</style>
</head>
<body>
	<div class="container">
		<img src="http://via.placeholder.com/100x100" alt="100*100">
		<img src="http://via.placeholder.com/100x120" alt="100*120">
		<img src="http://via.placeholder.com/100x80" alt="100*80">
		<img src="http://via.placeholder.com/100x150" alt="100*150">
		<img src="http://via.placeholder.com/100x100" alt="100*100">
		<img src="http://via.placeholder.com/100x120" alt="100*120">
		<img src="http://via.placeholder.com/100x80" alt="100*80">
		<img src="http://via.placeholder.com/100x150" alt="100*150">
		<img src="http://via.placeholder.com/100x100" alt="100*100">
		<img src="http://via.placeholder.com/100x120" alt="100*120">
		<img src="http://via.placeholder.com/100x80" alt="100*80">
		<img src="http://via.placeholder.com/100x150" alt="100*150">
		<img src="http://via.placeholder.com/100x100" alt="100*100">
		<img src="http://via.placeholder.com/100x120" alt="100*120">
		<img src="http://via.placeholder.com/100x80" alt="100*80">
		<img src="http://via.placeholder.com/100x150" alt="100*150">
		<img src="http://via.placeholder.com/100x100" alt="100*100">
		<img src="http://via.placeholder.com/100x120" alt="100*120">
		<img src="http://via.placeholder.com/100x80" alt="100*80">
		<img src="http://via.placeholder.com/100x150" alt="100*150">
	</div>
	<script>
		var colCount
		var hArr = []
		var imgWidth = $('.container img').outerWidth(true)
		colCount = Math.floor( $('.container').width()/imgWidth )
		console.log(colCount)

		for(var i=0; i<colCount; i++){
			hArr[i] = 0
		}
		//[0 ,0 ,0]
		$('.container img').on('load',function() {
			var minValue = hArr[0]
		    var minIndex = 0
			for(var i=0; i<colCount; i++) {
				if(hArr[i] < minValue) {
					minValue = hArr[i]
					minIndex = i
				}
			}
			$(this).css({
				left: minIndex * imgWidth,
				top: minValue
			})
			console.log($(this).outerHeight(true))
			hArr[minIndex] += $(this).outerHeight(true)
			console.log(hArr)
		})
		console.log($('.container img').eq(3).height())
	</script>
</body>
</html>